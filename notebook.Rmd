---
title: "Statistics"
output:
  html_document:
    df_print: paged
  pdf_document:
    keep_tex: yes
---

```{r}
library(flextable)

lastValues = c()
d <- NULL
k <- NULL
#d[1] = data.table::fread(sprintf('C:/Users/feroc/Documents/ThesisLocal/SimulationTree/mRNA_s22_c64_gl3_gn22_#0/initAaNumb_20/similar_true/aaRS_s23/livingAars_#0/output_s%s/codeTableFitness.csv', 0), header=FALSE, quote="\"")
#sum <- t(summary(tail(d[1][[1]], length(d[1][[1]])-20)))
#lastValues[1] = d[1][[1]][length(d[[1]])]
sum <- NULL
i =1
#for(i in 1){
  
  d[i+1] = data.table::fread(sprintf('C:/Users/feroc/Documents/ThesisLocal/SimulationTree/mRNA_s22_c64_gl3_gn22_#0/initAaNumb_19/similar_true/aaRS_s23/livingAars_#1/output_s%s/codeTableFitness.csv',i), header=FALSE, quote="\"")
  
  # rbind adds new row to sum. In this case all summaries are icluded in one dataframe
  sum <- rbind(sum, t(summary(tail(d[i+1][[1]], length(d[1+i][[1]])-20))))
  
  # lastValue of this data is added to Vector to be added to dataframe later on.
  lastValues[i+1] = d[i+1][[1]][length(d[[i+1]])]
#}

# cbind adds new column with values lastValues to dataframe sum
sum <- cbind(sum, lastValues)
# new column is named
colnames(sum)[7] <- "lastValue"


print(sum)

#summary(codeTableFitnesss)
#head(codeTableFitnesss, 10)

k[i+1] = data.table::fread(sprintf('C:/Users/feroc/Documents/ThesisLocal/SimulationTree/mRNA_s22_c64_gl3_gn22_#0/initAaNumb_19/similar_false/aaRS_s23/livingAars_#1/output_s%s/codeTableFitness.csv',i), header=FALSE, quote="\"")

```
```{r}

# plot Mean
plot(sum[,4])
# plot LastValue
plot(sum[,7])
```

```{r echo=FALSE}
library(ggpubr)
#ggqqplot(tail(d[1][[1]], length(d[1][[1]])-20))
ggqqplot(tail(d[1][[1]], 5000))
```
```{r}
#shapiro.test(tail(d[1][[1]], length(d[1][[1]])-20))
shapiro.test(tail(d[1][[1]], 5000))
```
```{r}
counts = c()
counts[1] <- length(which(d[1][[1]] <= 0.10)) 
counts[2] <- length(which(d[1][[1]] <= 0.11)) - length(which(d[1][[1]] <= 0.10))
counts[3] <- length(which(d[1][[1]] <= 0.12)) - length(which(d[1][[1]] <= 0.11))
counts[4] <- length(which(d[1][[1]] <= 0.13)) - length(which(d[1][[1]] <= 0.12))
counts[5] <- length(which(d[1][[1]] <= 0.14)) - length(which(d[1][[1]] <= 0.13))
counts[6] <- length(which(d[1][[1]] <= 0.15)) - length(which(d[1][[1]] <= 0.14))
counts[7] <- length(which(d[1][[1]] <= 0.16)) - length(which(d[1][[1]] <= 0.15))
counts[8] <- length(which(d[1][[1]] <= 0.17)) - length(which(d[1][[1]] <= 0.16))
counts[9] <- length(which(d[1][[1]] <= 0.18)) - length(which(d[1][[1]] <= 0.17))
counts[10] <- length(which(d[1][[1]] <= 0.19)) - length(which(d[1][[1]] <= 0.18))
counts
counts[2] <- counts[2]/201
counts[3] <- counts[3]/201
counts[4] <- counts[4]/201
counts[5] <- counts[5]/201
counts[6] <- counts[6]/201
counts[7] <- counts[7]/201
counts[8] <- counts[8]/201
counts

normalCheck <- c()
for(i in 0 : as.integer(counts[2])){
  normalCheck <- c(normalCheck, 0.11)
}
for(i in 0 : as.integer(counts[3])){
  normalCheck <- c(normalCheck, 0.12)
}
for(i in 0 : as.integer(counts[4])){
  normalCheck <- c(normalCheck, 0.13)
}
for(i in 0 : as.integer(counts[5])){
  normalCheck <- c(normalCheck, 0.14)
}
for(i in 0 : as.integer(counts[6])){
  normalCheck <- c(normalCheck, 0.15)
}
for(i in 0 : as.integer(counts[7])){
  normalCheck <- c(normalCheck, 0.16)
}
for(i in 0 : as.integer(counts[8])){
  normalCheck <- c(normalCheck, 0.17)
}
normalCheck
shapiro.test(normalCheck)
ks.test(normalCheck, "pnorm", mean = mean(normalCheck), sd = sd(normalCheck) )
ggqqplot(normalCheck)

```

```{r}
require(car)
sample1 <- d[1][[1]]
sample2 <- d[2][[1]]

#General code to reshape two vectors into a long data.frame
twoVarWideToLong <- function(sample1,sample2) {
    res <- data.frame(
        GroupID=as.factor(c(rep(1, length(sample1)), rep(2, length(sample2)))),
        DV=c(sample1, sample2)
    )   
}   

#Reshaping the example data
long.data <- twoVarWideToLong(sample1,sample2)

#There are many different calls here that will work... but here is an example
leveneTest(DV~GroupID,long.data)
ks.test(d[1][[1]], "pnorm")
hist(tail(d[1][[1]], length(d[1][[1]])-20))
histData <- hist(tail(d[1][[1]], length(d[1][[1]])-20))
histData$counts
```

```{r eval=FALSE, include=FALSE}
library(officer)
library(flextable)

codeTableFitness <- data.table::fread("~/HS/Semester/4/Thesis/Modeling/csv/codeTableFitness.csv", header=FALSE, quote="\"")

doc <- read_docx("hmm/thesis.docx")
ft <- regulartable(head(codeTableFitness, 10))
doc <- body_add_flextable(doc, value = ft)
print(doc, target = "hmm/thesis.docx")
ft
```



```{r}
dir(path = paste0(getwd(),"/hmm/", pattern=".docx"))
##character(0)
library(WordR)
library(officer)
library(ggplot2)

Plot <- plot(1:10, 1:10)
#addPlots("hmm/thesisTest.docx", "hmm/thesis2.docx", Plot, height = 4)
```

xtable is for making latex tables from r objects

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. 


```{r setup, include=FALSE}

require(ggplot2)
options(digits = 16) # Nachkommastellen (#Stellen)
knitr::opts_chunk$set(echo=FALSE, cache = TRUE)
```

Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Ctrl+Alt+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Ctrl+Shift+K* to preview the HTML file).

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.
