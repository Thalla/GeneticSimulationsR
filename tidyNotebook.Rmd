---
title: "R Notebook"
output:
  html_document:
    df_print: paged
---


```{r}
library(flextable)

basePath <- "G:/Hanna/SimulationTree/selection_false/translMethod_probability/"
configPath <- paste(basePath, "config.csv", sep = "")
config <- data.table::fread(configPath)
  #mRNA_s2000_c64_gl3_gn22_#1/initAaNumb_20/similar_true/aaRS_s200_ac6_lt10/livingAars_n22_s20/output_s1/codeTableFitness.csv")
ids <- c(1:nrow(config))
config <- cbind(ids, config)
colnames(config) <- c("id", "mrnaSeed", "codonNumb", "geneLength", "geneNumb", "mrnaId", "initAaNumb", "similarAars", "maxAnticodonNumb", "aarsLifeticksStartValue", "livingAarsStartNumb", "livingAarsSeed", "outputSeed", "addToOutput", "mrnaPath", "aarsPath", "livingAarsPath", "livingAarsDir")
outputPath <- paste(config$livingAarsDir, paste("output_s", config$outputSeed, sep = ""), sep = "")
fitnessPaths <- paste(outputPath, "codeTableFitness.csv", sep = "\\")
 
fitness <- c()
for(row in 1:length(fitnessPaths)){
  fitness[row] <- data.table::fread(fitnessPaths[row])
}

sum <- c()
for(row in 1:length(fitness)){
  sum <- rbind(sum, summary(fitness[[row]]))
}

config <- cbind(config, sum)





```

```{r}
#fitnessRow <- fitness[[which.max(config$Mean)]]
geneNumb30 <- config[which(config$geneNumb == 30)]
geneNumb30Mean <- mean(geneNumb30$Mean)

geneNumb15 <- config[which(config$geneNumb == 15)]
geneNumb15Mean <- mean(geneNumb15$Mean)

t.test(geneNumb15$Mean, geneNumb30$Mean)

library(tidyverse)
tibble(config)
anovaData <- select(config, aarsLifeticksStartValue, geneNumb, Mean)
anovaData <- anovaData[which(anovaData$geneNumb == 30)]

anovaData <- select(config, id, aarsLifeticksStartValue, Mean)

library(psych)
description <- describeBy(anovaData, anovaData$aarsLifeticksStartValue)
description
boxplot(anovaData$Mean ~ anovaData$aarsLifeticksStartValue, main = "Boxplot", xlab = "Group (ltStartValue)", ylab = "Mean", outline = TRUE)

# Inter group variance

# Define number of subjects in each group
##n <- description[[1]]$n
n <- 4320#length(which(anovaData$aarsLifeticksStartValue == 2))

# Calculate group means
y_j <- tapply(anovaData$Mean, anovaData$aarsLifeticksStartValue, mean)

# Calculate the grand mean
y_t <- mean(y_j)

# Calculate the sum of squares
ss_a <- n*sum((y_j - y_t)^2)

# Intra group variance

# Create a separate vector of Means for each training group
y_i1 <- subset(anovaData$Mean, anovaData$aarsLifeticksStartValue == 2)
y_i2 <- subset(anovaData$Mean, anovaData$aarsLifeticksStartValue == 5)
y_i3 <- subset(anovaData$Mean, anovaData$aarsLifeticksStartValue == 10)
y_i4 <- subset(anovaData$Mean, anovaData$aarsLifeticksStartValue == 15)

# Subtract group means from the individual values
s_1 <- y_i1 - y_j[1]
s_2 <- y_i2 - y_j[2]
s_3 <- y_i3 - y_j[3]
s_4 <- y_i4 - y_j[4]

# Put everything back together into one vector
s_t <- c(s_1, s_2, s_3, s_4)

# Calculate the sum of squares using s_t
ss_sa <- sum(s_t^2)

# calculate F-Value

# Number of groups
a <- 4

# Define degrees of freedom
df_a <- a - 1
df_sa <- a*(n-1)

# Calculate mean squares using ss_a and ss_sa
ms_a <- ss_a / df_a
ms_sa <- ss_sa / df_sa

# Calculate the F-ratio
f_rat <- ms_a / ms_sa

f_rat

anovaResult <- aov(Mean ~ as.factor(aarsLifeticksStartValue), data = anovaData)
anovaSummary <- summary(anovaResult)

anovaSummary

library(mvoutlier)

#which(config$geneNumb == 30, arr.ind = FALSE, useNames = FALSE)
```






```{r}
#data <- tail(data$V1,length(data$V1)-20)
#data
#summary(data)
#data <- tail(data, 1000)

data <- config$Mean
norm <- rnorm(length(data), mean(data), sd(data))
chisq.test(data, norm)
```

